<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>An Introduction to Statistical Learning</title>
  <meta name="description" content="This is a minimally documented implementation of <em>An Introduction to Statistical Learning</em> using a <code>tidyverse</code> philosophy for all the applications in R.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="An Introduction to Statistical Learning" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a minimally documented implementation of <em>An Introduction to Statistical Learning</em> using a <code>tidyverse</code> philosophy for all the applications in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="An Introduction to Statistical Learning" />
  
  <meta name="twitter:description" content="This is a minimally documented implementation of <em>An Introduction to Statistical Learning</em> using a <code>tidyverse</code> philosophy for all the applications in R." />
  

<meta name="author" content="Benjamin Soltoff">


<meta name="date" content="2018-07-23">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="stat-learn.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">(Tidy) ISLR</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>What this is about</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="stat-learn.html"><a href="stat-learn.html"><i class="fa fa-check"></i><b>2</b> What is statistical learning?</a><ul>
<li class="chapter" data-level="2.1" data-path="stat-learn.html"><a href="stat-learn.html#what-is-statistical-learning"><i class="fa fa-check"></i><b>2.1</b> What is statistical learning?</a></li>
<li class="chapter" data-level="2.2" data-path="stat-learn.html"><a href="stat-learn.html#assessing-model-accuracy"><i class="fa fa-check"></i><b>2.2</b> Assessing model accuracy</a></li>
<li class="chapter" data-level="2.3" data-path="stat-learn.html"><a href="stat-learn.html#lab-introduction-to-r"><i class="fa fa-check"></i><b>2.3</b> Lab: Introduction to R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="stat-learn.html"><a href="stat-learn.html#basic-commands"><i class="fa fa-check"></i><b>2.3.1</b> Basic commands</a></li>
<li class="chapter" data-level="2.3.2" data-path="stat-learn.html"><a href="stat-learn.html#graphics"><i class="fa fa-check"></i><b>2.3.2</b> Graphics</a></li>
<li class="chapter" data-level="2.3.3" data-path="stat-learn.html"><a href="stat-learn.html#indexing-data"><i class="fa fa-check"></i><b>2.3.3</b> Indexing data</a></li>
<li class="chapter" data-level="2.3.4" data-path="stat-learn.html"><a href="stat-learn.html#loading-data"><i class="fa fa-check"></i><b>2.3.4</b> Loading data</a></li>
<li class="chapter" data-level="2.3.5" data-path="stat-learn.html"><a href="stat-learn.html#additional-graphical-and-numerical-summaries"><i class="fa fa-check"></i><b>2.3.5</b> Additional graphical and numerical summaries</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="stat-learn.html"><a href="stat-learn.html#install-and-load-tidyverse-packages"><i class="fa fa-check"></i><b>2.4</b> Install and load tidyverse packages</a></li>
<li class="chapter" data-level="2.5" data-path="stat-learn.html"><a href="stat-learn.html#session-information"><i class="fa fa-check"></i><b>2.5</b> Session information</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lin-reg.html"><a href="lin-reg.html"><i class="fa fa-check"></i><b>3</b> Linear regression</a><ul>
<li class="chapter" data-level="3.1" data-path="lin-reg.html"><a href="lin-reg.html#simple-linear-regression"><i class="fa fa-check"></i><b>3.1</b> Simple linear regression</a></li>
<li class="chapter" data-level="3.2" data-path="lin-reg.html"><a href="lin-reg.html#multiple-linear-regression"><i class="fa fa-check"></i><b>3.2</b> Multiple linear regression</a></li>
<li class="chapter" data-level="3.3" data-path="lin-reg.html"><a href="lin-reg.html#other-considerations-in-the-regression-model"><i class="fa fa-check"></i><b>3.3</b> Other considerations in the regression model</a></li>
<li class="chapter" data-level="3.4" data-path="lin-reg.html"><a href="lin-reg.html#the-marketing-plan"><i class="fa fa-check"></i><b>3.4</b> The marketing plan</a></li>
<li class="chapter" data-level="3.5" data-path="lin-reg.html"><a href="lin-reg.html#comparison-of-linear-regression-with-k-nearest-neighbors"><i class="fa fa-check"></i><b>3.5</b> Comparison of linear regression with <span class="math inline">\(K\)</span>-nearest neighbors</a></li>
<li class="chapter" data-level="3.6" data-path="lin-reg.html"><a href="lin-reg.html#lab-linear-regression"><i class="fa fa-check"></i><b>3.6</b> Lab: Linear regression</a><ul>
<li class="chapter" data-level="3.6.1" data-path="lin-reg.html"><a href="lin-reg.html#libraries"><i class="fa fa-check"></i><b>3.6.1</b> Libraries</a></li>
<li class="chapter" data-level="3.6.2" data-path="lin-reg.html"><a href="lin-reg.html#simple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.2</b> Simple linear regression</a></li>
<li class="chapter" data-level="3.6.3" data-path="lin-reg.html"><a href="lin-reg.html#multiple-linear-regression-1"><i class="fa fa-check"></i><b>3.6.3</b> Multiple linear regression</a></li>
<li class="chapter" data-level="3.6.4" data-path="lin-reg.html"><a href="lin-reg.html#interaction-terms"><i class="fa fa-check"></i><b>3.6.4</b> Interaction terms</a></li>
<li class="chapter" data-level="3.6.5" data-path="lin-reg.html"><a href="lin-reg.html#non-linear-transformations-of-the-predictors"><i class="fa fa-check"></i><b>3.6.5</b> Non-linear transformations of the predictors</a></li>
<li class="chapter" data-level="3.6.6" data-path="lin-reg.html"><a href="lin-reg.html#qualitative-predictors"><i class="fa fa-check"></i><b>3.6.6</b> Qualitative predictors</a></li>
<li class="chapter" data-level="3.6.7" data-path="lin-reg.html"><a href="lin-reg.html#writing-functions"><i class="fa fa-check"></i><b>3.6.7</b> Writing functions</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="lin-reg.html"><a href="lin-reg.html#session-information-1"><i class="fa fa-check"></i><b>3.7</b> Session information</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">An Introduction to Statistical Learning</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="lin-reg" class="section level1">
<h1><span class="header-section-number">3</span> Linear regression</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<pre><code>## ── Attaching packages ───────────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 3.0.0     ✔ purrr   0.2.5
## ✔ tibble  1.4.2     ✔ dplyr   0.7.6
## ✔ tidyr   0.8.1     ✔ stringr 1.3.1
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.5.1</code></pre>
<pre><code>## ── Conflicts ──────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<div id="simple-linear-regression" class="section level2">
<h2><span class="header-section-number">3.1</span> Simple linear regression</h2>
</div>
<div id="multiple-linear-regression" class="section level2">
<h2><span class="header-section-number">3.2</span> Multiple linear regression</h2>
</div>
<div id="other-considerations-in-the-regression-model" class="section level2">
<h2><span class="header-section-number">3.3</span> Other considerations in the regression model</h2>
</div>
<div id="the-marketing-plan" class="section level2">
<h2><span class="header-section-number">3.4</span> The marketing plan</h2>
</div>
<div id="comparison-of-linear-regression-with-k-nearest-neighbors" class="section level2">
<h2><span class="header-section-number">3.5</span> Comparison of linear regression with <span class="math inline">\(K\)</span>-nearest neighbors</h2>
</div>
<div id="lab-linear-regression" class="section level2">
<h2><span class="header-section-number">3.6</span> Lab: Linear regression</h2>
<div id="libraries" class="section level3">
<h3><span class="header-section-number">3.6.1</span> Libraries</h3>
<p><code>ISLR</code> contains several datasets associated with <strong>An Introduction to Statistical Learning</strong>. <code>MASS</code> also contains a large number of data sets and functions, one of which is used in this lab. However <code>MASS</code> also contains a function called <code>filter()</code>, which would conflict with <code>filter()</code> from <code>dplyr</code>. To avoid this conflict, we can use <code>data()</code> to directly access the data frame without loading the entire <code>MASS</code> package. We then convert this data frame to a tibble using <code>as_tibble()</code> to ensure proper formatting and appearance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ISLR)
<span class="kw">data</span>(Boston, <span class="dt">package =</span> <span class="st">&quot;MASS&quot;</span>)

Boston &lt;-<span class="st"> </span><span class="kw">as_tibble</span>(Boston)
Boston</code></pre></div>
<pre><code>## # A tibble: 506 x 14
##      crim    zn indus  chas   nox    rm   age   dis   rad   tax ptratio
## *   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt;   &lt;dbl&gt;
## 1 0.00632    18  2.31     0 0.538  6.58  65.2  4.09     1   296    15.3
## 2 0.0273      0  7.07     0 0.469  6.42  78.9  4.97     2   242    17.8
## 3 0.0273      0  7.07     0 0.469  7.18  61.1  4.97     2   242    17.8
## 4 0.0324      0  2.18     0 0.458  7.00  45.8  6.06     3   222    18.7
## 5 0.0690      0  2.18     0 0.458  7.15  54.2  6.06     3   222    18.7
## 6 0.0298      0  2.18     0 0.458  6.43  58.7  6.06     3   222    18.7
## # ... with 500 more rows, and 3 more variables: black &lt;dbl&gt;, lstat &lt;dbl&gt;,
## #   medv &lt;dbl&gt;</code></pre>
</div>
<div id="simple-linear-regression-1" class="section level3">
<h3><span class="header-section-number">3.6.2</span> Simple linear regression</h3>
<p><code>Boston</code> is a dataset of neighborhood statistics for 506 neighborhoods around Boston, Massachusetts. We will attempt to predict <code>medv</code> (median value of owner-occupied homes in $1000s) using 13 predictors such as <code>rm</code> (average number of rooms per house), <code>age</code> (average age of houses), and <code>lstat</code> (percent of households with low socioeconomic status). To estimate a linear regression model in R, use the core <code>lm()</code> function. The syntax is <code>lm(response ~ predictors, data = dataframe)</code>, like this:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>lstat, <span class="dt">data =</span> Boston)</code></pre></div>
<p>To view a summary of the linear regression model, the base R approach uses <code>summary()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(lm_fit)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = medv ~ lstat, data = Boston)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -15.17  -3.99  -1.32   2.03  24.50 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  34.5538     0.5626    61.4   &lt;2e-16 ***
## lstat        -0.9500     0.0387   -24.5   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 6.22 on 504 degrees of freedom
## Multiple R-squared:  0.544,  Adjusted R-squared:  0.543 
## F-statistic:  602 on 1 and 504 DF,  p-value: &lt;2e-16</code></pre>
<p>This prints some output to the console, including information about the coefficients, standard errors, and overall model statistics. This approach is not tidy because the object containing all this information is not a data frame. Instead, we can use the <a href="https://broom.tidyverse.org/"><code>broom</code> package</a> to summarize and extract key information about statistical models in tidy <code>tibble</code>s. To view summaries about each component of the model (in this case, the regression coefficients), use <code>tidy()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(broom)

<span class="kw">tidy</span>(lm_fit)</code></pre></div>
<pre><code>##          term estimate std.error statistic   p.value
## 1 (Intercept)    34.55    0.5626      61.4 3.74e-236
## 2       lstat    -0.95    0.0387     -24.5  5.08e-88</code></pre>
<p><code>glance()</code> returns a tibble with one row of goodness of fit measures and related statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(lm_fit)</code></pre></div>
<pre><code>##   r.squared adj.r.squared sigma statistic  p.value df logLik  AIC  BIC
## 1     0.544         0.543  6.22       602 5.08e-88  2  -1641 3289 3302
##   deviance df.residual
## 1    19472         504</code></pre>
<p><code>augment()</code> returns a data frame with one row per observation from the original dataset and adds information such as fitted values, residuals, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">augment</span>(lm_fit) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">as_tibble</span>()</code></pre></div>
<pre><code>## # A tibble: 506 x 9
##    medv lstat .fitted .se.fit .resid    .hat .sigma   .cooksd .std.resid
##   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
## 1  24    4.98    29.8   0.406 -5.82  0.00426   6.22 0.00189       -0.939
## 2  21.6  9.14    25.9   0.308 -4.27  0.00246   6.22 0.000582      -0.688
## 3  34.7  4.03    30.7   0.433  3.97  0.00486   6.22 0.00100        0.641
## 4  33.4  2.94    31.8   0.467  1.64  0.00564   6.22 0.000198       0.264
## 5  36.2  5.33    29.5   0.396  6.71  0.00406   6.21 0.00238        1.08 
## 6  28.7  5.21    29.6   0.399 -0.904 0.00413   6.22 0.0000440     -0.146
## # ... with 500 more rows</code></pre>
<p>To visualize the linear regression model, we can use <code>geom_smooth()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> Boston, <span class="kw">aes</span>(<span class="dt">x =</span> lstat, <span class="dt">y =</span> medv)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="03-linear-regression_files/figure-html/lm-viz-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>This not only draws the best fit line but also generates a 95% confidence interval.</p>
<p>Visualizing diagnostic plots can also be done using <code>augment()</code> and <code>ggplot()</code>. <code>augment()</code> automatically calculates statistics such as residuals and leverage statistics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">augment</span>(lm_fit) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Fitted value&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Residual&quot;</span>)

<span class="kw">augment</span>(lm_fit) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> .fitted, <span class="dt">y =</span> .std.resid)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Fitted value&quot;</span>,
       <span class="dt">y =</span> <span class="st">&quot;Standardized residual&quot;</span>)

<span class="kw">augment</span>(lm_fit) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> .hat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Hat value&quot;</span>)</code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="03-linear-regression_files/figure-html/lm-augment-viz-1.png" width="70%" style="display: block; margin: auto;" /><img src="03-linear-regression_files/figure-html/lm-augment-viz-2.png" width="70%" style="display: block; margin: auto;" /><img src="03-linear-regression_files/figure-html/lm-augment-viz-3.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-linear-regression-1" class="section level3">
<h3><span class="header-section-number">3.6.3</span> Multiple linear regression</h3>
<p>Again we use <code>lm()</code>, now specifying multiple predictors using <code>x1 + x2 + x3</code> notation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>lstat <span class="op">+</span><span class="st"> </span>age, <span class="dt">data =</span> Boston)
<span class="kw">tidy</span>(lm_fit)</code></pre></div>
<pre><code>##          term estimate std.error statistic   p.value
## 1 (Intercept)  33.2228    0.7308     45.46 2.94e-180
## 2       lstat  -1.0321    0.0482    -21.42  8.42e-73
## 3         age   0.0345    0.0122      2.83  4.91e-03</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(lm_fit)</code></pre></div>
<pre><code>##   r.squared adj.r.squared sigma statistic  p.value df logLik  AIC  BIC
## 1     0.551         0.549  6.17       309 2.98e-88  3  -1638 3283 3300
##   deviance df.residual
## 1    19168         503</code></pre>
<p>To automatically regress on all of the available predictors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> Boston)
<span class="kw">tidy</span>(lm_fit)</code></pre></div>
<pre><code>##           term  estimate std.error statistic  p.value
## 1  (Intercept)  3.65e+01   5.10346    7.1441 3.28e-12
## 2         crim -1.08e-01   0.03286   -3.2865 1.09e-03
## 3           zn  4.64e-02   0.01373    3.3816 7.78e-04
## 4        indus  2.06e-02   0.06150    0.3343 7.38e-01
## 5         chas  2.69e+00   0.86158    3.1184 1.93e-03
## 6          nox -1.78e+01   3.81974   -4.6513 4.25e-06
## 7           rm  3.81e+00   0.41793    9.1161 1.98e-18
## 8          age  6.92e-04   0.01321    0.0524 9.58e-01
## 9          dis -1.48e+00   0.19945   -7.3980 6.01e-13
## 10         rad  3.06e-01   0.06635    4.6129 5.07e-06
## 11         tax -1.23e-02   0.00376   -3.2800 1.11e-03
## 12     ptratio -9.53e-01   0.13083   -7.2825 1.31e-12
## 13       black  9.31e-03   0.00269    3.4668 5.73e-04
## 14       lstat -5.25e-01   0.05072  -10.3471 7.78e-23</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glance</span>(lm_fit)</code></pre></div>
<pre><code>##   r.squared adj.r.squared sigma statistic   p.value df logLik  AIC  BIC
## 1     0.741         0.734  4.75       108 6.72e-135 14  -1499 3028 3091
##   deviance df.residual
## 1    11079         492</code></pre>
<p>Use <code>vif()</code> from the <code>car</code> package to calculate variance inflation factors (VIFs).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(car)</code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">vif</span>(lm_fit)</code></pre></div>
<pre><code>##    crim      zn   indus    chas     nox      rm     age     dis     rad 
##    1.79    2.30    3.99    1.07    4.39    1.93    3.10    3.96    7.48 
##     tax ptratio   black   lstat 
##    9.01    1.80    1.35    2.94</code></pre>
</div>
<div id="interaction-terms" class="section level3">
<h3><span class="header-section-number">3.6.4</span> Interaction terms</h3>
<p>Use the syntax <code>lstat * age</code> to simultaneously include <code>lstat</code>, <code>age,</code> and the interaction term <code>lstat x age</code>. <a href="https://doi.org/10.1093/pan/mpi014">Never omit constitutive terms.</a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>lstat <span class="op">*</span><span class="st"> </span>age, <span class="dt">data =</span> Boston) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">tidy</span>()</code></pre></div>
<pre><code>##          term  estimate std.error statistic  p.value
## 1 (Intercept) 36.088536   1.46984   24.5528 4.91e-88
## 2       lstat -1.392117   0.16746   -8.3134 8.78e-16
## 3         age -0.000721   0.01988   -0.0363 9.71e-01
## 4   lstat:age  0.004156   0.00185    2.2443 2.52e-02</code></pre>
</div>
<div id="non-linear-transformations-of-the-predictors" class="section level3">
<h3><span class="header-section-number">3.6.5</span> Non-linear transformations of the predictors</h3>
<p>Add non-linear transformations of predictors using <code>I(x ^ 2)</code> notation. So to add a second-order polynomial term:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit2 &lt;-<span class="st"> </span><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span>lstat <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(lstat <span class="op">^</span><span class="st"> </span><span class="dv">2</span>), <span class="dt">data =</span> Boston)
<span class="kw">tidy</span>(lm_fit2)</code></pre></div>
<pre><code>##          term estimate std.error statistic   p.value
## 1 (Intercept)  42.8620   0.87208      49.1 3.50e-194
## 2       lstat  -2.3328   0.12380     -18.8  2.55e-60
## 3  I(lstat^2)   0.0435   0.00375      11.6  7.63e-28</code></pre>
<p>Third and higher order terms are best implemented using <code>poly()</code>, which allows you to specify the highest-order term and all lower-order terms are automatically created.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit5 &lt;-<span class="st"> </span><span class="kw">lm</span>(medv <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(<span class="dt">x =</span> lstat, <span class="dt">degree =</span> <span class="dv">5</span>), <span class="dt">data =</span> Boston)
<span class="kw">tidy</span>(lm_fit5)</code></pre></div>
<pre><code>##                           term estimate std.error statistic   p.value
## 1                  (Intercept)     22.5     0.232     97.20  0.00e+00
## 2 poly(x = lstat, degree = 5)1   -152.5     5.215    -29.24 2.69e-110
## 3 poly(x = lstat, degree = 5)2     64.2     5.215     12.32  1.25e-30
## 4 poly(x = lstat, degree = 5)3    -27.1     5.215     -5.19  3.10e-07
## 5 poly(x = lstat, degree = 5)4     25.5     5.215      4.88  1.42e-06
## 6 poly(x = lstat, degree = 5)5    -19.3     5.215     -3.69  2.47e-04</code></pre>
</div>
<div id="qualitative-predictors" class="section level3">
<h3><span class="header-section-number">3.6.6</span> Qualitative predictors</h3>
<p>Examine the <code>CarSeats</code> data in the <code>ISLR</code> library.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">as_tibble</span>(Carseats)</code></pre></div>
<pre><code>## # A tibble: 400 x 11
##   Sales CompPrice Income Advertising Population Price ShelveLoc   Age
## * &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;dbl&gt;
## 1  9.5        138     73          11        276   120 Bad          42
## 2 11.2        111     48          16        260    83 Good         65
## 3 10.1        113     35          10        269    80 Medium       59
## 4  7.4        117    100           4        466    97 Medium       55
## 5  4.15       141     64           3        340   128 Bad          38
## 6 10.8        124    113          13        501    72 Bad          78
## # ... with 394 more rows, and 3 more variables: Education &lt;dbl&gt;,
## #   Urban &lt;fct&gt;, US &lt;fct&gt;</code></pre>
<p>While some of the variables are continuous, others such as <code>ShelveLoc</code> (quality of shelf location) are qualitative. <code>ShelveLoc</code> takes on three possible values: <em>Bad</em>, <em>Medium</em>, and <em>Good</em>. Given qualitative variables, R automatically converts them to a series of dummy variables with <code>0/1</code> coding:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lm_fit &lt;-<span class="st"> </span><span class="kw">lm</span>(Sales <span class="op">~</span><span class="st"> </span>. <span class="op">+</span><span class="st"> </span>Income<span class="op">:</span>Advertising <span class="op">+</span><span class="st"> </span>Price<span class="op">:</span>Age, <span class="dt">data =</span> Carseats)
<span class="kw">tidy</span>(lm_fit)</code></pre></div>
<pre><code>##                  term  estimate std.error statistic   p.value
## 1         (Intercept)  6.575565  1.008747     6.519  2.22e-10
## 2           CompPrice  0.092937  0.004118    22.567  1.64e-72
## 3              Income  0.010894  0.002604     4.183  3.57e-05
## 4         Advertising  0.070246  0.022609     3.107  2.03e-03
## 5          Population  0.000159  0.000368     0.433  6.65e-01
## 6               Price -0.100806  0.007440   -13.549  1.74e-34
## 7       ShelveLocGood  4.848676  0.152838    31.724 1.38e-109
## 8     ShelveLocMedium  1.953262  0.125768    15.531  1.34e-42
## 9                 Age -0.057947  0.015951    -3.633  3.18e-04
## 10          Education -0.020852  0.019613    -1.063  2.88e-01
## 11           UrbanYes  0.140160  0.112402     1.247  2.13e-01
## 12              USYes -0.157557  0.148923    -1.058  2.91e-01
## 13 Income:Advertising  0.000751  0.000278     2.698  7.29e-03
## 14          Price:Age  0.000107  0.000133     0.801  4.24e-01</code></pre>
</div>
<div id="writing-functions" class="section level3">
<h3><span class="header-section-number">3.6.7</span> Writing functions</h3>
</div>
</div>
<div id="session-information-1" class="section level2 toc-ignore">
<h2><span class="header-section-number">3.7</span> Session information</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw">session_info</span>()</code></pre></div>
<pre><code>## Session info -------------------------------------------------------------</code></pre>
<pre><code>##  setting  value                       
##  version  R version 3.5.0 (2018-04-23)
##  system   x86_64, darwin15.6.0        
##  ui       X11                         
##  language (EN)                        
##  collate  en_US.UTF-8                 
##  tz       America/Chicago             
##  date     2018-07-23</code></pre>
<pre><code>## Packages -----------------------------------------------------------------</code></pre>
<pre><code>##  package   * version date       source        
##  backports   1.1.2   2017-12-13 CRAN (R 3.5.0)
##  base      * 3.5.0   2018-04-24 local         
##  bookdown    0.7     2018-02-18 CRAN (R 3.5.0)
##  compiler    3.5.0   2018-04-24 local         
##  datasets  * 3.5.0   2018-04-24 local         
##  devtools    1.13.5  2018-02-18 CRAN (R 3.5.0)
##  digest      0.6.15  2018-01-28 CRAN (R 3.5.0)
##  evaluate    0.10.1  2017-06-24 CRAN (R 3.5.0)
##  graphics  * 3.5.0   2018-04-24 local         
##  grDevices * 3.5.0   2018-04-24 local         
##  htmltools   0.3.6   2017-04-28 CRAN (R 3.5.0)
##  knitr       1.20    2018-02-20 CRAN (R 3.5.0)
##  magrittr    1.5     2014-11-22 CRAN (R 3.5.0)
##  memoise     1.1.0   2017-04-21 CRAN (R 3.5.0)
##  methods   * 3.5.0   2018-04-24 local         
##  Rcpp        0.12.17 2018-05-18 CRAN (R 3.5.0)
##  rmarkdown   1.9     2018-03-01 CRAN (R 3.5.0)
##  rprojroot   1.3-2   2018-01-03 CRAN (R 3.5.0)
##  stats     * 3.5.0   2018-04-24 local         
##  stringi     1.2.2   2018-05-02 CRAN (R 3.5.0)
##  stringr     1.3.1   2018-05-10 CRAN (R 3.5.0)
##  tools       3.5.0   2018-04-24 local         
##  utils     * 3.5.0   2018-04-24 local         
##  withr       2.1.2   2018-03-15 CRAN (R 3.5.0)
##  xfun        0.1     2018-01-22 CRAN (R 3.5.0)
##  yaml        2.1.19  2018-05-01 CRAN (R 3.5.0)</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="stat-learn.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/uc-cfss/tidy-islr03-linear-regression.Rmd",
"text": "Edit"
},
"download": null,
"toc": {
"collapse": "subsection"
},
"theme": "readable",
"highlight": "pygments"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
